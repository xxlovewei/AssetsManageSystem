<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="Expires" CONTENT="-1">
<meta http-equiv="Cache-Control" CONTENT="no-cache">
<meta http-equiv="Pragma" CONTENT="no-cache">
<title>位置信息</title>
</head>
<body>

	<script type="text/javascript" src="../../public/jquery/jquery.js"></script>
	<script type="text/javascript" src="../../public/ajaxpost.js"></script>
	<script type="text/javascript"
		src="../../public/weixin/jweixin-1.2.0.js"></script>
	<script>
 
	function getParam(paramName) { 
	    paramValue = "", isFound = !1; 
	    if (this.location.search.indexOf("?") == 0 && this.location.search.indexOf("=") > 1) { 
	        arrSource = unescape(this.location.search).substring(1, this.location.search.length).split("&"), i = 0; 
	        while (i < arrSource.length && !isFound) arrSource[i].indexOf("=") > 0 && arrSource[i].split("=")[0].toLowerCase() == paramName.toLowerCase() && (paramValue = arrSource[i].split("=")[1], isFound = !0), i++ 
	    } 
	    return paramValue == "" && (paramValue = null), paramValue 
	} 
		
		//请求门店
		var daim=getParam("daim");

		var mddata={};
		$.getJSON("/mayormp/sign.do?url="
							+ encodeURIComponent(location.href.split('#')[0]),
							function(rat) {
								console.log(rat);
								wx.config({
									debug : false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
									appId : rat.appId, // 必填，企业号的唯一标识，此处填写企业号corpid
									timestamp : rat.timestamp, // 必填，生成签名的时间戳
									nonceStr : rat.nonceStr, // 必填，生成签名的随机串
									signature : rat.signature,// 必填，签名，见附录1
									jsApiList : [ 'checkJsApi', 'openLocation',
											'getLocation' ]
								// 必填，需要使用的JS接口列表，所有JS接口列表见附录2
								});
							});
	
		
 
		wx.ready(function() {
				 
			ajaxpost(
				"/api/md/mddata.do",{
					id : daim
				},
				function(res) {
					var md=res[0];
					var latitude =  md.wweid;
					var longitude = md.wjind;
				 
					wx.openLocation({
						latitude : latitude, // 纬度，浮点数，范围为90 ~ -90
						longitude : longitude, // 经度，浮点数，范围为180 ~ -180。
						name : md.mingc, // 位置名
						address : md.diz, // 地址详情说明
						scale : 20, // 地图缩放级别,整形值,范围从1~28。默认为最大
						infoUrl : 'http://www.youngor.com' // 在查看位置界面底部显示的超链接,可点击跳转
					});
					
	});
			
		
			//wx.getLocation({
			//	type : 'gcj02', // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'
			//	success : function(res) {
			//	}
			//});
		});
	</script>
</body>

</html>