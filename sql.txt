select
 h.host,
 h.name,
(select max(a.value) from history_uint a, items b where a.clock>unix_timestamp(date_sub(now(), interval 2 hour) )  and b.hostid= t.hostid and a.itemid=b.itemid and key_='vm.memory.size[total]' ORDER BY a.clock DESC LIMIT 3 ) total_mem_v,
(select max(a.value) from history_uint a, items b where a.clock>unix_timestamp(date_sub(now(), interval 2 hour) )  and b.hostid= t.hostid and a.itemid=b.itemid and key_='system.swap.size[,total]' ORDER BY a.clock DESC LIMIT 3 ) total_swapmem_v,
(select max(a.value) from history_str a, items b  where a.clock>unix_timestamp(date_sub(now(), interval 12 hour) ) and b.hostid= t.hostid and a.itemid=b.itemid and key_='system.hostname' ORDER BY a.clock DESC LIMIT 3 ) system_hostname_v,
(select max(a.value) from history_uint a, items b where a.clock>unix_timestamp(date_sub(now(), interval 12 hour) ) and b.hostid= t.hostid and a.itemid=b.itemid and key_='system.uptime' ORDER BY a.clock DESC LIMIT 3 ) system_uptime_v,
 (select max(a.value) from history_str a, items b where a.clock>unix_timestamp(date_sub(now(), interval 2 hour) ) and b.hostid= t.hostid and a.itemid=b.itemid and key_='system.uname' ORDER BY a.clock DESC LIMIT 3 ) system_name_v,
 (select max(a.value) from history_str a, items b where a.clock>unix_timestamp(date_sub(now(), interval 2 hour) ) and b.hostid= t.hostid and a.itemid=b.itemid and key_='agent.version' ORDER BY a.clock DESC LIMIT 3 ) agent_version_v,
 t.*
from hosts_templates t,hosts h where h.hostid=t.hostid and t.templateid=10001



select  DATE_FORMAT(FROM_UNIXTIME(clock),'%Y-%m-%d') createTime, severity ,sum(severity) cnt from problem  a where  a.clock>unix_timestamp(date_sub(now(), interval 720 hour) )  group by
  DATE_FORMAT(FROM_UNIXTIME(clock),'%Y-%m-%d') , severity order by 1,2
